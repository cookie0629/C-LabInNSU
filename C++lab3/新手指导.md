## 项目新手指导 / Руководство для новичков

本文件帮助第一次接触本项目的同学快速上手，并回答 `第三题.md` 中 **第 7–21 行** 的要求，对应到具体代码位置。  
Этот файл помогает новичкам быстро понять проект и показывает,
как требования задания (строки 7–21 в `第三题.md`) реализованы в коде.

---

### 一、项目简介 / Краткое описание проекта

- **项目名称 / Имя проекта**: 简易正则表达式解释器 (Simple Regex Engine)
- **功能 / Назначение**:
  - 从标准输入读取一个正则表达式模式；
  - 对后续每一行输入字符串判断是否 **完全匹配** 该模式；
  - 对每一行输出 `true` 或 `false`。

核心实现位于：

- `src/regex_engine.hpp` / `src/regex_engine.cpp` —— 正则引擎 + 解析器；
- `src/main.cpp` —— 控制台应用，处理标准输入/输出；
- `tests/test_main.cpp` —— 单元测试，验证行为；
- `CMakeLists.txt` + `src/CMakeLists.txt` + `tests/CMakeLists.txt` —— 构建系统。

---

### 二、如何构建与运行 / Как собрать и запустить

在项目根目录 `F:\C++lab3` 打开 PowerShell：

```powershell
mkdir build
cd build
cmake ..
cmake --build . --config Debug   # 或 Release
```

运行命令行程序（以 Debug 为例）：

```powershell
.\src\Debug\regex_cli.exe
```

交互示例：

```text
[a-c]+      <- 第一行：模式 / шаблон
abc         <- 待匹配字符串 / строка
d	
abcc
```

输出：

```text
true
false
true
```

运行单元测试：

```powershell
ctest -C Debug      # 或 ctest -C Release
```

所有测试应显示 100% 通过。

---

### 三、对应 `第三题.md` 7–21 行的回答 / Ответ на требования задания

#### 1. 学生技能 (L7–L11)

- **能够使用 C++ 标准输入/输出库**
  - **代码位置 / Код**:
    - `src/main.cpp` 中使用 `std::cin`, `std::cout`, `std::getline` 读写；
    - `tests/test_main.cpp` 使用 `std::cout`, `std::cerr` 输出测试结果。
- **能够使用 C++ 动态内存管理功能**
  - **代码位置 / Код**:
    - `src/regex_engine.hpp` / `src/regex_engine.cpp`
      - 使用 `std::shared_ptr<Node>` (`using NodePtr = std::shared_ptr<Node>;`) 管理 AST 节点的生命周期；
      - 通过工厂式 `std::make_shared<...>` 创建节点，而不是裸 `new`，体现现代 C++ RAII 风格。

#### 2. 任务完成要求 (L12–L19)

> C++ 应用程序项目应：

- **拥有构建系统 / Иметь систему сборки**
  - **代码位置 / Код**:
    - 顶层 `CMakeLists.txt`：声明项目、启用 C++17、添加 `src` 与 `tests` 子目录；
    - `src/CMakeLists.txt`：编译 `regex_engine` 静态库与 `regex_cli` 可执行文件；
    - `tests/CMakeLists.txt`：编译 `regex_tests` 并通过 `add_test` 注册到 CTest。

- **拥有单元测试 / Иметь модульные тесты**
  - **代码位置 / Код**:
    - `tests/test_main.cpp`：
      - 定义一组 `Case{ pattern, text, expected }`；
      - 使用 `regex_engine::full_match` 对各种输入输出场景进行验证；
      - main 返回 0/1 作为测试结果；
    - `tests/CMakeLists.txt` 通过 `add_test(NAME regex_tests COMMAND regex_tests)` 集成到 CTest。

- **根据描述的技术规范演示程序行为 / Демонстрировать поведение по тех. заданию**
  - **正则语法支持 / Поддерживаемый синтаксис**:
    - **字面量字符** `a..z, A..Z, 0..9, 空格`
      - 解析与匹配代码：`Parser::parseAtom()` 中的 “// literal” 分支，
        生成 `Atom(Atom::Kind::Literal, c, q)`；
    -  **点号 "." 匹配任意单个字符**
      - `Parser::parseAtom()` 中 `if (c == '.')` 分支，使用 `Atom::Kind::Any`；
      - 匹配逻辑在 `Atom::matchesSingle` 中 `case Kind::Any: return true;`；
    - **字符组 "[...]" + 范围 "a-d"**
      - `Parser::parseCharClass()`：
        - 解析 `[...]` 内的单个字符和 `x-y` 形式的范围；
        - 存储到 `std::vector<Atom::CharClassRange>`；
      - 匹配在 `Atom::matchesSingle` 的 `case Kind::CharClass` 中，通过区间判断。
    - **修饰符 "*"、"+"、"?"**
      - 量词解析：`Parser::parseQuantifier()`，根据下一个字符设置：
        - `*` → `min=0, max=无限, greedy=true`；
        - `+` → `min=1, max=无限, greedy=true`；
        - `?` → `min=0, max=1, greedy=false`（懒惰）；
      - 实际匹配：`Atom::match()`：
        - 循环匹配单个原子，统计 `count`；
        - 检查 `count >= min`；
        - `greedy=true` 时取最大 `count`；`greedy=false` 时取最小允许次数。
  - **整串匹配 / Полное совпадение строки**
    - `regex_engine::full_match(pattern, text)`：
      - 先 `compile(pattern)` 得到 AST；
      - 调用 `root->match(text, 0, pos)`；
      - 仅当返回 true 且 `pos == text.size()` 时认为完全匹配。

- **要求以面向对象的风格完成任务 / Выполнить задание в ООП‑стиле**
  - 体现面向对象的地方：
    - 抽象基类 `Node` + 多态虚函数 `match`；
    - 派生类 `Atom`、`Sequence` 实现各自的匹配逻辑；
    - `Parser` 作为单独类，封装解析状态（`pattern_`, `pos_`）；
    - 对外只暴露干净的函数接口 `compile` 和 `full_match`，隐藏内部实现细节。

#### 3. 预备材料 (L21 之后) 的落实 / Реализация подготовительных требований

- **解释正则表达式并将其应用于字符串**
  - 解析（解释）部分：
    - `Parser` 类读取模式字符串，构造一棵 AST（`Sequence` + `Atom`）；
  - 应用到字符串：
    - `full_match` 把 AST 应用到具体的 `text`，根据定义规则输出 true/false；
  - 命令行封装：
    - `src/main.cpp` 按行读取输入并调用 `full_match`，实现题目描述的 I/O 行为。

---

### 四、如果你是第一次读这份代码 / С чего начать изучение кода

1. 先看 `README.md` 和本文件，了解工程结构和 I/O 协议；
2. 再读 `src/main.cpp`，理解程序入口如何调用引擎；
3. 接着看 `src/regex_engine.hpp`：
   - 先理解 `Node` / `Atom` / `Sequence` 的职责；
   - 再看 `Parser` 的方法声明；
4. 然后阅读 `src/regex_engine.cpp`：
   - 从 `Atom::match` 入手，看量词是如何工作的；
   - 再看 `Parser::parseAtom` / `parseCharClass` / `parseQuantifier`；
5. 最后查看 `tests/test_main.cpp` 中的用例，尝试自己增加一些新的测试。

通过这些步骤，新手可以比较系统地理解这个小型正则引擎项目，同时清晰地对应到课程任务文档中的每一项要求。  
Следуя этим шагам, начинающий разработчик сможет разобраться в проекте
и увидеть, как каждая часть задания реализована в коде.

