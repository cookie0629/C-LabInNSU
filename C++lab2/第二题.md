**[文件名]: C++ ФИТ 2025 - Задача 2.docx**

**[文件内容开始]**

# 任务目标

运用 C++ 语言的面向对象模型知识，通过使用面向对象编程（OOP）模式来模拟现实世界的领域。

# 学生技能

-   能够独立使用 C++ 语言工具开发复杂领域模型。
-   能够理解并运用面向对象编程模式。
-   了解并掌握 C++ 语言中类、结构和枚举定义的语法和语义。

# 任务完成要求

项目程序必须：

-   拥有构建系统
-   拥有单元测试
-   根据描述的技术要求演示程序行为
-   准备好 UML 类图（可使用 PlantUML）
-   为每个操作准备好 UML 序列图（可使用 PlantUML）

# 准备材料

在此任务中，需要基于领域模型模拟银行分行的工作。模拟的输入是通过程序标准输入流（**stdin**）提供的字符串命令，格式为每行 1 条命令。一条命令可以包含多个数据元素，也是每行 1 个元素。命令分为：

-   初始数据集合
-   分行中发生的事件流

程序任务：

-   记住模拟的初始数据集合。
-   对于每个需要决策的事件，根据为该事件设定的格式输出决策到程序的标准输出流（**stdout**）。
-   对于数据输出事件，输出当前的数据表。

对于输入和输出处理，应使用 C 风格的数据解析和格式化——函数 **std::scanf(...)**、**std::printf(...)** 和 **std::fprintf(stderr, ...)**。保证所有输入到程序的消息都具有有效格式。每个消息的解析和格式化格式如下所述。

## 银行分行工作领域模型

在领域范围内，我们考虑数据和流程。

### 基本数据类型

#### 无符号整数

以十进制表示的数字
在程序中表示为类型：unsigned long long int
扫描字符串："%llu"

#### 浮点数

根据 std::strtod() 函数格式以十进制表示的数字
在程序中表示为类型：double
扫描字符串："%le"
示例：123.45E-5

#### 时间

一天中的小时（24小时制）：0 - 23（无符号整数）
分隔符 ":"
当前小时的分钟：0-59（无符号整数）
扫描字符串："%llu:%llu"
示例：23:59, 00:00, 12:34, 08:30

#### 日期

从模拟开始算起当前天的序号（无符号整数）
示例：1, 1582, 9999

#### 货币单位

定点数 - 小数点后 3 位
在程序中表示为类型：**double**
此类数字需要四舍五入到小数点后 3 位
> 舍入：(((long long int)(x * 10000) + 5 * (x < 0.0 ? -1 : 1)) / 10) / 1000.0
> 示例：round(999999.0004) == 999999.000; round(-999999.0005) == -999999.001
> 扫描字符串："%llu.%llu"
> 示例：0.000; 1999.999

#### 字符串

长度最多 99 个字符的字符串
在程序中表示为类型：char[100]，以 '\0' 结尾
扫描字符串："%99[a-zA-Z0-9/_ ]"
示例（全名）："Hitchcock Alfred Joseph", "Tarantino Quentin Jerome"

### 复合数据类型

#### 账户

唯一账号：无符号整数
账户类型：字符串
账户资金量：货币单位
账户货币：字符串

#### 存款

唯一存款编号：无符号整数
利率：浮点数
> 以百分比表示，例如 6.320 - 年利率 6.32% 或年系数 1.0632
> 年利率按半年重新计算，除以二（1.0632 / 2 = 1.0316）。
> 年利率按季度重新计算，除以四（1.0632 / 4 = 1.0158）。
> 年利率按月重新计算，除以十二（1.0632 / 12 = 1.00527）。
> 年利率按天重新计算，除以三百六十五（1.0632 / 365 = 1.000017315）。

存款类型：字符串
存款创建日期：日期
存款总期限（天数）：无符号整数

#### 贷款

唯一贷款编号：无符号整数
利率：浮点数（参见存款）
贷款金额：货币单位
贷款类型：字符串

#### 银行客户

客户唯一编号：无符号整数
姓 名 父名 / 组织名称：字符串
客户类型：字符串

#### 客户账户

客户唯一编号：无符号整数
唯一账号：无符号整数
唯一存款编号：无符号整数

#### 银行内部账户

唯一账号：无符号整数

#### 客户债务

客户唯一编号：无符号整数
唯一账号：无符号整数
唯一贷款编号：无符号整数

#### 工作岗位

工作岗位类型：字符串
分行中该岗位数量：无符号整数

#### 汇率

客户出售的货币：字符串
客户购买的货币：字符串
兑换系数：浮点数（客户购买的货币与客户出售的货币之比）

### 枚举

#### 账户类型

借记账户："debit"
存款："deposit"
贷款账户："credit"

#### 账户货币

卢布："RUB"
人民币："YUAN"
美元："USD"
欧元："EUR"

#### 存款类型

按余额每日复利："Compounded Daily Remaining"
按最低余额每日复利："Compounded Daily Min"
按余额每月复利："Compounded Monthly Remaining"
按最低余额每月复利："Compounded Monthly Min"
按余额每季度复利："Compounded Quarterly Remaining"
按最低余额每季度复利："Compounded Quarterly Min"
按余额每半年复利："Compounded Semi-Annually Remaining"
按最低余额每半年复利："Compounded Semi-Annually Min"
按余额每年复利："Compounded Annually Remaining"
按最低余额每年复利："Compounded Annually Min"

#### 贷款类型

每日计息："Charged Daily"
每月计息："Charged Monthly"
每季度计息："Charged Quarterly"
每半年计息："Charged Semi-annually"
每年计息："Charged Annually"

#### 客户类型

个人客户："Individual Client"
法人实体："Legal Entity"
优先个人客户："VIP Individual Client"
优先法人实体："VIP Legal Entity"
非客户："Not a Client"

#### 工作岗位类型

客户服务窗口："Client Manager"
现金柜台："Cash Desk"
货币兑换点："Currency Exchange"
优先客户经理："VIP Client Manager"

### 输入数据

程序开始时，按以下顺序连续输入数据：

#### 账户

第一行记录数：无符号整数 "Accounts %llu\n"
接着是记录数量的行数
-   账户："%llu # %99[a-zA-Z0-9/_ ] # %llu.%llu # %99[a-zA-Z0-9/_ ]\n"

#### 存款

第一行记录数：无符号整数 "Debits %llu\n"
接着是记录数量的行数
-   存款："%llu # %le # %99[a-zA-Z0-9/_ ] # %llu # %llu\n"

#### 贷款

第一行记录数：无符号整数 "Credits %llu\n"
接着是记录数量的行数
-   贷款："%llu # %le # %llu.%llu # %99[a-zA-Z0-9/_ ]\n"

#### 银行客户

第一行记录数：无符号整数 "Clients %llu\n"
接着是记录数量的行数
-   银行客户："%llu # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ]\n"

#### 客户账户

第一行记录数：无符号整数 "Client Debit %llu\n"
接着是记录数量的行数
-   客户账户："%llu # %llu # %llu\n"

#### 银行内部账户

第一行记录数：无符号整数 "Bank Accounts %llu\n"
接着是记录数量的行数
-   银行内部账户："%llu\n"

#### 客户债务

第一行记录数：无符号整数 "Client Credit %llu\n"
接着是记录数量的行数
-   客户债务："%llu # %llu # %llu\n"

#### 工作岗位

第一行记录数：无符号整数 "Work Places %llu\n"
接着是记录数量的行数
-   工作岗位："%99[a-zA-Z0-9/_ ] # %llu\n"

#### 汇率

第一行记录数：无符号整数 "Exchange Rates %llu\n"
接着是记录数量的行数
-   汇率："%99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ] # %le\n"

### 领域流程

**手续费** - 因某项操作而向客户收取并存入银行内部账户的金额。该金额以操作所在货币存入银行内部账户。保证每种货币都有其对应的银行内部账户。

**交易日志** - 关于银行内资金流动的数据。要求将银行内的任何资金流动输出到此交易日志。为此，应使用函数 **std::fprintf(stderr, ...)**。输出格式：

-   账户间转账："%llu # %llu:%llu # %llu -> %llu # %llu.%llu\n"。其中格式说明符：
    -   当前日期
    -   当前时间
    -   转出资金的账户号
    -   接收资金的账户号
    -   转账金额（货币单位）
-   账户充值："%llu # %llu:%llu # -> %llu # %llu.%llu\n"。其中格式说明符：
    -   当前日期
    -   当前时间
    -   接收资金的账户号
    -   转账金额（货币单位）
-   从账户提款："%llu # %llu:%llu # %llu -> # %llu.%llu\n"。其中格式说明符：
    -   当前日期
    -   当前时间
    -   转出资金的账户号
    -   转账金额（货币单位）

交易日志还包括所有**手续费**的转账。

#### 银行营业日

银行营业日从 8:00 开始，到 19:00 结束。对于在营业日开始之前或结束之后来到银行的访客，应拒绝服务，并说明"在银行非工作时间办理业务"（Bank closed until 8:00）。

如果在银行营业日结束时间到来时，大厅内仍有客户，对于此时未被银行员工处理的所有客户，应拒绝其剩余未完成的服务，并说明"银行即将关闭"（Bank is closing at 19:00）。对于当前正在处理的剩余客户，如果其剩余服务需要转移到其他工作岗位才能完成，则应拒绝这些服务，并说明"银行已关闭"（Bank is closed until tomorrow 8:00）。

银行营业日伴随以下事件。

##### 银行营业日开始

事件格式："%llu # %llu:%llu # Start of Bank Day"，其中格式说明符：
-   当前日期
-   事件时间
无论此事件何时到达，银行营业日均在 8:00 开始。此事件可能在 8:00 之前或之后到达。

##### 银行营业日结束

事件格式："%llu # %llu:%llu # End of Bank Day"，其中格式说明符：
-   当前日期
-   事件时间
无论此事件何时到达，银行营业日均在 19:00 结束。此事件可能在 19:00 之前或之后到达。

当此事件发生时：
-   对于所有类型为"Compounded Daily Remaining"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于账户余额乘以存款年利率（按日折算），前提是该金额为正。
-   对于所有类型为"Compounded Daily Min"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于该日账户最低余额乘以存款年利率（按日折算），前提是该金额为正。
-   对于所有类型为"Charged Daily"的贷款，需要从贷款账户（以贷款货币）向银行内部账户转出一笔金额，该金额等于（贷款金额与贷款账户当前余额之差）乘以贷款年利率（按日折算），前提是该差值为正。

首先需要处理所有贷款，然后处理所有存款。

如果由于资金不足无法从银行内部账户执行转账，则程序应输出消息"银行违约"（Bank defaulted）并以错误代码 EXIT_FAILURE 退出。

需要输出银行中每个工作岗位当天服务了多少客户，格式为："%llu # %s # %llu # %llu"，其中格式说明符：
-   当前日期
-   工作岗位类型
-   工作岗位序号，从 1 开始
-   服务的客户数量

##### 银行月末

事件格式："%llu # %llu:%llu # End of Bank Month"，其中格式说明符：
-   当前日期
-   事件时间
当此事件发生时：
-   对于所有类型为"Compounded Monthly Remaining"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于账户余额乘以存款年利率（按月折算），前提是该金额为正。
-   对于所有类型为"Compounded Monthly Min"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于该月账户最低余额乘以存款年利率（按月折算），前提是该金额为正。
-   对于所有类型为"Charged Monthly"的贷款，需要从贷款账户（以贷款货币）向银行内部账户转出一笔金额，该金额等于（贷款金额与贷款账户当前余额之差）乘以贷款年利率（按月折算），前提是该差值为正。

首先需要处理所有贷款，然后处理所有存款。

如果由于资金不足无法从银行内部账户执行转账，则程序应输出消息"银行违约"（Bank defaulted）并以错误代码 EXIT_FAILURE 退出。

##### 银行季度末

事件格式："%llu # %llu:%llu # End of Bank Quater"，其中格式说明符：
-   当前日期
-   事件时间
当此事件发生时：
-   对于所有类型为"Compounded Quarterly Remaining"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于账户余额乘以存款年利率（按季度折算），前提是该金额为正。
-   对于所有类型为"Compounded Quarterly Min"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于该季度账户最低余额乘以存款年利率（按季度折算），前提是该金额为正。
-   对于所有类型为"Charged Quarterly"的贷款，需要从贷款账户（以贷款货币）向银行内部账户转出一笔金额，该金额等于（贷款金额与贷款账户当前余额之差）乘以贷款年利率（按季度折算），前提是该差值为正。

首先需要处理所有贷款，然后处理所有存款。

如果由于资金不足无法从银行内部账户执行转账，则程序应输出消息"银行违约"（Bank defaulted）并以错误代码 EXIT_FAILURE 退出。

如果由于资金不足无法从客户贷款账户执行转账，则程序应输出消息"客户违约"（Client defaulted）并以错误代码 EXIT_FAILURE 退出。

##### 银行半年度末

事件格式："%llu # %llu:%llu # End of Bank Semi-Annual period"，其中格式说明符：
-   当前日期
-   事件时间
当此事件发生时：
-   对于所有类型为"Compounded Semi-Annually Remaining"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于账户余额乘以存款年利率（按半年折算），前提是该金额为正。
-   对于所有类型为"Compounded Semi-Annually Min"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于该半年度账户最低余额乘以存款年利率（按半年折算），前提是该金额为正。
-   对于所有类型为"Charged Semi-annually"的贷款，需要从贷款账户（以贷款货币）向银行内部账户转出一笔金额，该金额等于（贷款金额与贷款账户当前余额之差）乘以贷款年利率（按半年折算），前提是该差值为正。

首先需要处理所有贷款，然后处理所有存款。

如果由于资金不足无法从银行内部账户执行转账，则程序应输出消息"银行违约"（Bank defaulted）并以错误代码 EXIT_FAILURE 退出。

##### 银行年度末

事件格式："%llu # %llu:%llu # End of Bank Annual period"，其中格式说明符：
-   当前日期
-   事件时间
当此事件发生时：
-   对于所有类型为"Compounded Annually Remaining"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于账户余额乘以存款年利率，前提是该金额为正。
-   对于所有类型为"Compounded Annually Min"的存款账户，需要从银行内部账户（以存款货币）转入一笔金额，该金额等于该年度账户最低余额乘以存款年利率，前提是该金额为正。
-   对于所有类型为"Charged Annually"的贷款，需要从贷款账户（以贷款货币）向银行内部账户转出一笔金额，该金额等于（贷款金额与贷款账户当前余额之差）乘以贷款年利率，前提是该差值为正。

首先需要处理所有贷款，然后处理所有存款。

如果由于资金不足无法从银行内部账户执行转账，则程序应输出消息"银行违约"（Bank defaulted）并以错误代码 EXIT_FAILURE 退出。

需要输出银行中每个工作岗位当年服务了多少客户，格式为："%llu # %s # %llu # %llu"，其中格式说明符：
-   当前日期
-   工作岗位类型
-   工作岗位序号，从 1 开始
-   服务的客户数量

#### 客户亲临办理

亲临办理时，客户选择服务类型并领取排队号码。如果所有服务都可以在一个工作岗位上完成，则该岗位的员工将按顺序执行这些服务。如果不是所有服务都能在一个工作岗位上完成，则客户在完成可以在该岗位完成的服务后，会额外领取一个号码，并重复办理流程。

亲临办理时，银行客户可进行以下类型的操作。

-   查询账户余额
-   开户
-   销户
-   从账户取款
-   为账户充值
-   获取贷款
-   申请信用卡
-   领取信用卡
-   开立存款
-   申请借记卡
-   领取借记卡
-   货币兑换

亲临办理消息格式：

第一行："%llu # %llu:%llu # Personal Appeal # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ] # %llu"。格式说明符对应：
1.  当前日期
2.  办理时间
3.  姓 名 父名 / 组织名称
4.  客户类型标识符："Individual", "Legal Entity"
5.  操作行数

从下一行开始，是该客户的操作行，数量 exactly 与最后一个格式说明符中指定的数量相同。

##### 新客户注册

如果办公室访客不是银行客户，则要求其访问目的之一是：
-   开户
-   提交借记卡申请

否则，应拒绝为该访客服务，并说明"客户错误"（Client error. Wrong operation for new client）。

如果满足上述条件，则需要将访客注册为银行客户。此操作需要 15 分钟。它仅在"客户服务窗口"执行。

然后，像对待新来的客户一样，为该客户提供所需的服务。

##### 账户操作

###### 查询账户余额

客户可以查询其拥有的任何账户的余额。此操作需要 5 分钟。手续费：0%。

如果客户查询不属于其的账户余额，则应拒绝执行该服务，并说明"客户错误"（Client error. Access denied）。

如果指定账户不存在，银行应拒绝该操作（Client error. Unknown account）。

操作格式："Balance Inquiry # %llu"，其中格式说明符 - 账户号码。
输出格式："%llu # %llu:%llu # Balance of %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   账户号码
-   账户余额（货币单位）

###### 开户

客户可以开立结算账户并用于在银行存储资金。此操作需要 10 分钟。

手续费如下表所示。

|      | 个人客户 | 优先个人客户 | 法人实体 | 优先法人实体 |
| ---- | -------- | ------------ | -------- | ------------ |
| RUB  | 10,000   | 4,000        | 25,000   | 15,000       |
| YUAN | 2,000    | 1,000        | 5,000    | 2,000        |
| USD  | 100      | 50           | 200      | 100          |
| EUR  | 100      | 50           | 200      | 100          |

表中的数据表示开户当天从账户中收取的货币单位。因此，账户开立时的余额为负。

为客户开户时会创建一个新的唯一账户。此账户是存款账户。此类账户的利率为 0.0%。存款类型 - 任意。

创建的实体：账户、存款、客户账户。

操作格式："Create Account # %99[a-zA-Z0-9/_ ]"，其中格式说明符 - 账户货币。
输出格式："%llu # %llu:%llu # Account Created %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   开立的账户号码
-   开户后的账户余额（货币单位）

银行客户可以开立的最大账户数量（包括贷款账户、信用卡账户、借记卡账户、存款账户和普通账户）在下表中说明。

|      | 个人客户 | 优先个人客户 | 法人实体 | 优先法人实体 |
| ---- | -------- | ------------ | -------- | ------------ |
| RUB  | 3        | 5            | 10       | 25           |
| YUAN | 1        | 5            | 5        | 15           |
| USD  | 1        | 3            | 5        | 10           |
| EUR  | 1        | 3            | 5        | 10           |

在"开户"、"获取贷款"、"领取信用卡"、"开立存款"、"领取借记卡"操作中，如果超出账户数量限制，应拒绝客户并说明"客户错误"（Client error. Active account limit reached）。

###### 销户

客户可以关闭其开立的账户、借记卡和信用卡账户。此操作需要 25 分钟。

手续费：账户剩余资金的 1.5%，但不少于 10 个货币单位。

如果账户余额为负，则应拒绝销户，并说明"负余额"（Client error. Negative balance on closure）。

客户只能关闭属于其的账户。如果尝试关闭不属于客户的账户，则应拒绝执行该服务，并说明"客户错误"（Client error. Access denied）。

如果指定账户不存在，银行应拒绝该操作（Client error. Unknown account）。

客户只能关闭其明确开立的账户（通过"开户"、"领取借记卡"、"领取信用卡"操作）。通过以下方式开立的账户：
-   "获取贷款"开立的账户在贷款完全偿还后自动关闭。
-   "领取信用卡"开立的账户，如果在办理"销户"服务时信用卡没有欠款（即，债务总额与账户余额之差小于或等于零），则可以关闭。
    -   手续费：0%。
    -   如果仍有欠款，则应拒绝执行"销户"服务，并说明"信贷未结清"（Credit in action）。
-   "开立存款"开立的账户，在客户从存款账户中取出所有资金后自动关闭。

提供"销户"服务后，对于已关闭账户的所有服务和操作，应拒绝并说明"账户无效"（Account closed）。

已关闭的账户不计入客户最大账户数量限制。

操作格式："Close Account # %llu"，其中格式说明符 - 账户号码。
输出格式："%llu # %llu:%llu # Account closed %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   关闭的账户号码
-   因销户而获得的现金金额（以账户货币计）（货币单位）

###### 从账户取款

客户可以从其账户中取款。此操作需要 10 分钟。

手续费：取款金额的 0.25%，但不少于 2.5 个货币单位。

此操作需要 5 分钟。

客户只能从属于其的账户中取款，否则应拒绝并说明"客户错误"（Client error. Access denied）。

如果指定账户不存在，银行应拒绝该操作（Client error. Unknown account）。

客户取款金额不能超过账户余额（包括手续费）。如果尝试进行此类取款，应拒绝客户并说明"客户错误"（Client error. Insufficient funds）

客户可以从以下账户取款：
-   通过"开户"操作开立的账户
-   通过"开立存款"操作开立的账户，仅在存款期满后。手续费：0.0%
-   通过"领取信用卡"操作开立的账户
-   通过"领取借记卡"操作开立的账户

操作格式："Withdraw Funds # %llu # %llu.%llu"，其中格式说明符：
-   账户号码
-   取款金额（以账户货币计）（货币单位）
输出格式："%llu # %llu:%llu # Funds Withdrawn %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   账户号码
-   账户剩余资金（货币单位）

###### 为账户充值

客户可以为其账户充值。此操作需要 5 分钟。

手续费：充值金额的 0.01%，但不少于 1 个货币单位。

此操作需要 5 分钟。

客户只能为属于其的账户充值，否则应拒绝并说明"客户错误"（Client error. Access denied）。

如果指定账户不存在，银行应拒绝该操作（Client error. Unknown account）。

客户可以为以下账户充值：
-   通过"开户"操作开立的账户
-   通过"获取贷款"操作开立的账户，当向该账户存入金额时，贷款账户的最终余额不能超过发放的贷款金额。如果存入金额超过，应拒绝客户并说明"客户错误"（Client error. Invalid loan payment amount）
-   通过"领取信用卡"操作开立的账户
-   通过"领取借记卡"操作开立的账户

操作格式："Top-up Founds # %llu # %llu.%llu"，其中格式说明符：
-   账户号码
-   充值金额（以账户货币计）（货币单位）
输出格式："%llu # %llu:%llu # Fonds Credited %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   账户号码
-   账户剩余资金（以账户货币计）（货币单位）

##### 贷款操作

###### 获取贷款

客户可以从银行获得贷款。贷款以信贷形式发放，并为其开立一个信贷账户。贷款的全部金额在贷款发放时支付给客户（即信贷账户在开立时余额为零）。此操作需要 45 分钟。

手续费：贷款金额的 0.1%。

贷款按以下年利率发放给客户。

|      | 个人客户 | 优先个人客户 | 法人实体 | 优先法人实体 |
| ---- | -------- | ------------ | -------- | ------------ |
| RUB  | 12.2%    | 9.9%         | 16.7%    | 15.0%        |
| YUAN | 4.3%     | 4.0%         | 6.3%     | 5.8%         |
| USD  | 2.1%     | 1.5%         | 4.1%     | 3.6%         |
| EUR  | 1.9%     | 1.1%         | 3.2%     | 3.1%         |

贷款金额受以下数值限制。

|      | 个人客户  | 优先个人客户 | 法人实体   | 优先法人实体 |
| ---- | --------- | ------------ | ---------- | ------------ |
| RUB  | 3,000,000 | 15,000,000   | 50,000,000 | 100,000,000  |
| YUAN | 600,000   | 1,200,000    | 10,000,000 | 25,000,000   |
| USD  | 15,000    | 95,000       | 600,000    | 1,000,000    |
| EUR  | 20,000    | 100,000      | 750,000    | 1,300,000    |

发放贷款时，贷款的全部金额将从银行内部账户（以贷款货币）中扣除。如果银行内部账户资金不足，则应拒绝客户获取贷款，并说明"无法处理贷款"（Can't process credit）。

当贷款自动关闭时（当其完全偿还时），贷款账户上的全部金额将转入银行内部账户（以贷款货币），并且账户关闭。

创建的实体：账户、贷款、客户债务。

为贷款开立账户的服务不受"开户"操作的手续费约束。

操作格式："Get Loan # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ] # %llu.%llu"，其中格式说明符：
-   货币
-   请求的贷款类型
-   贷款金额（货币单位）
输出格式："%llu # %llu:%llu # Loan Approved %llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   贷款账户号码

###### 申请信用卡

客户可以提交信用卡申请。此操作需要 10 分钟。

手续费：0.0%

信用卡按以下年利率发放。

|      | 个人客户 | 优先个人客户 | 法人实体 | 优先法人实体 |
| ---- | -------- | ------------ | -------- | ------------ |
| RUB  | 24.5%    | 21.2%        | 30.1%    | 29.7%        |
| YUAN | 16.0%    | 15.6%        | 20.1%    | 18.7%        |
| USD  | 9%       | 7.2%         | 13.4%    | 12.2%        |
| EUR  | 8.5%     | 7.5%         | 14.7%    | 12.8%        |

信用卡限额与贷款金额限额一致。

操作格式："Request Credit Card # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ] # %llu.%llu"，其中格式说明符：
-   货币
-   请求的贷款类型
-   信贷账户金额（货币单位）
输出格式："%llu # %llu:%llu # Credit Card Application Received"，其中格式说明符：
-   当前日期
-   操作执行时间

###### 领取信用卡

客户可以领取其之前申请过的信用卡。此操作需要 5 分钟。

手续费：0.0%

客户必须在"申请信用卡"操作之后不少于 3 天且不超过 30 天内办理此操作。如果客户提前办理，应拒绝其服务并说明"客户错误"（Client error. Credit Card application not yet approved）。如果客户逾期办理，应拒绝其服务并说明"客户错误"（Client error. Credit Card application out of date）。

发放信用卡时，贷款的全部金额将从银行内部账户（以贷款货币）转入信用卡账户。如果银行内部账户资金不足，则应拒绝客户领取信用卡，并说明"无法处理信用卡"（Can't process credit card）。

创建的实体：账户、贷款、客户债务。

为信用卡开立账户的服务受"开户"操作的手续费约束。手续费从信用卡账户中收取。

操作格式："Get Credit Card # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ] # %llu.%llu"，其中格式说明符：
-   货币
-   请求的贷款类型
-   信贷账户金额（货币单位）
输出格式："%llu # %llu:%llu # Credit Card Approved # %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   信用卡账户号码
-   信用卡账户资金金额（货币单位）

##### 存款操作

###### 开立存款

客户可以将钱存入银行以获取利息，期限固定。但是，客户不能使用这笔钱（执行"从账户取款"操作）或补充存款（执行"为账户充值"操作）。此操作需要 20 分钟。

手续费：0.0%

银行按以下年利率开立存款。

|              | 个人客户 | 优先个人客户 | 法人实体 | 优先法人实体 |
| ------------ | -------- | ------------ | -------- | ------------ |
| RUB 3 个月   | 9.0%     | 9.9%         | -//-     | 10.3%        |
| RUB 6 个月   | 9.7%     | 10.1%        | -//-     | 11.2%        |
| RUB 12 个月  | 11.5%    | 11.9%        | -//-     | 12.0%        |
| RUB 24 个月  | 12.1%    | 12.3%        | -//-     | 12.4%        |
| YUAN 3 个月  | 2.6%     | 3.2%         | -//-     | 2.9%         |
| YUAN 6 个月  | 2.8%     | 3.5%         | -//-     | 3.4%         |
| YUAN 12 个月 | 3.9%     | 3.8%         | -//-     | 3.7%         |
| YUAN 24 个月 | 4.1%     | 4.0%         | -//-     | 4.2%         |
| USD 3 个月   | 1.3%     | 1.7%         | -//-     | 1.4%         |
| USD 6 个月   | 1.5%     | 2.0%         | -//-     | 1.9%         |
| USD 12 个月  | 1.8%     | 2.3%         | -//-     | 2.3%         |
| USD 24 个月  | 2.0%     | 2.5%         | -//-     | 2.3%         |
| EUR 3 个月   | 0.7%     | 1.1%         | -//-     | 1.1%         |
| EUR 6 个月   | 1.1%     | 1.7%         | -//-     | 1.5%         |
| EUR 12 个月  | 1.5%     | 1.8%         | -//-     | 2.1%         |
| EUR 24 个月  | 1.9%     | 1.9%         | -//-     | 2.2%         |

创建的实体：账户、存款、客户账户。

为存款开立账户的服务不受"开户"操作的手续费约束。

操作格式："Make Deposit # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ] # %llu.%llu"，其中格式说明符：
-   货币
-   请求的存款类型
-   存款货币
-   存款期限："3 month" (90 天), "6 month" (182 天), "12 month" (365 天), "24 month" (730 天)
-   存款金额（货币单位）
输出格式："%llu # %llu:%llu # Deposit Approved # %llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   存款账户号码

**部分准备金银行制度**

为了避免违约，银行可以临时动用高达存款金额 80% 的资金存入银行内部账户。银行支付的存款利息保持不变，就像没有发生动用一样。

###### 申请借记卡

客户可以提交借记卡申请。此操作需要 10 分钟。

手续费：0.0%

借记卡为银行客户带来利润，并具有以下年利率。

|                     | 个人客户 | 优先个人客户 | 法人实体 | 优先法人实体 |
| ------------------- | -------- | ------------ | -------- | ------------ |
| RUB 按余额计息      | 3.9%     | 5.3%         | 4.2%     | 6.2%         |
| RUB 按最低余额计息  | 4.5%     | 5.7%         | 5.1%     | 6.7%         |
| YUAN 按余额计息     | 2.1%     | 2.5%         | 3.2%     | 4.9%         |
| YUAN 按最低余额计息 | 2.4%     | 3.1%         | 3.7%     | 5.1%         |
| USD 按余额计息      | 0.7%     | 1.0%         | 1.7%     | 2.1%         |
| USD 按最低余额计息  | 0.9%     | 1.2%         | 1.9%     | 2.3%         |
| EUR 按余额计息      | 0.74%    | 0.9%         | 1.4%     | 1.95%        |
| EUR 按最低余额计息  | 0.83%    | 1.15%        | 1.6%     | 2.3%         |

操作格式："Request Debit Card # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ]"，其中格式说明符：
-   货币
-   请求的存款类型
输出格式："%llu # %llu:%llu # Debit Card Application Received"，其中格式说明符：
-   当前日期
-   操作执行时间

###### 领取借记卡

客户可以领取其之前申请过的借记卡。此操作需要 5 分钟。

手续费：0.0%

客户必须在"申请借记卡"操作之后不少于 5 天且不超过 15 天内办理此操作。如果客户提前办理，应拒绝其服务并说明"客户错误"（Client error. Debit Card application not yet approved）。如果客户逾期办理，应拒绝其服务并说明"客户错误"（Client error. Debit Card application out of date）。

创建的实体：账户、存款、客户账户。

为借记卡开立账户的服务受"开户"操作的手续费约束。手续费从借记卡账户中收取。

操作格式："Get Debit Card # %99[a-zA-Z0-9/_ ] # %99[a-zA-Z0-9/_ ]"，其中格式说明符：
-   货币
-   请求的贷款类型
输出格式："%llu # %llu:%llu # Debit Card Approved # %llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   借记卡账户号码

##### 货币兑换

客户可以在银行兑换货币。此操作需要 10 分钟。

货币兑换通过两个操作进行：
1.  从客户处接收现金并将其存入银行内部账户（相应货币）。
2.  从银行内部账户（客户想要购买的货币）中取出相当于货币汇率的金额。

手续费：0.0%

如果转出货币的银行内部账户资金不足，则银行应拒绝该操作（Can't perform exchange）。

操作格式："Currency Exchange # %99[a-zA-Z0-9/_ ] -> %99[a-zA-Z0-9/_ ] # %llu.%llu"，其中格式说明符：
-   客户出售的货币
-   客户打算购买的货币
-   客户出售的货币金额（货币单位）
输出格式："%llu # %llu:%llu # Currency Exchange Performed # %llu.%llu "，其中格式说明符：
-   当前日期
-   操作执行时间
-   客户购买的货币金额（货币单位）

##### 工作岗位执行的操作

| 操作类型     | 非客户       | 个人客户     | 优先个人客户 | 法人实体     | 优先法人实体 |
| ------------ | ------------ | ------------ | ------------ | ------------ | ------------ |
| 新客户注册   | 客户服务窗口 | 不提供服务   | 不提供服务   | 不提供服务   | 不提供服务   |
| 查询账户余额 | 不提供服务   | 客户服务窗口 | 优先客户经理 | 客户服务窗口 | 优先客户经理 |
| 开户         | 不提供服务   | 客户服务窗口 | 优先客户经理 | 客户服务窗口 | 优先客户经理 |
| 销户         | 不提供服务   | 客户服务窗口 | 优先客户经理 | 客户服务窗口 | 优先客户经理 |
| 获取贷款     | 不提供服务   | 现金柜台     | 现金柜台     | 现金柜台     | 现金柜台     |
| 申请信用卡   | 不提供服务   | 客户服务窗口 | 优先客户经理 | 不提供服务   | 优先客户经理 |
| 领取信用卡   | 不提供服务   | 客户服务窗口 | 优先客户经理 | 不提供服务   | 优先客户经理 |
| 申请借记卡   | 不提供服务   | 客户服务窗口 | 优先客户经理 | 客户服务窗口 | 优先客户经理 |
| 领取借记卡   | 不提供服务   | 客户服务窗口 | 优先客户经理 | 客户服务窗口 | 优先客户经理 |
| 货币兑换     | 不提供服务   | 货币兑换点   | 货币兑换点   | 不提供服务   | 货币兑换点   |
| 从账户取款   | 不提供服务   | 现金柜台     | 现金柜台     | 现金柜台     | 现金柜台     |
| 为账户充值   | 不提供服务   | 现金柜台     | 现金柜台     | 现金柜台     | 现金柜台     |
| 开立存款     | 不提供服务   | 客户服务窗口 | 优先客户经理 | 不提供服务   | 优先客户经理 |

如果根据上表，某项服务不提供，则应拒绝客户办理该服务（而非所有请求的服务），并说明"服务不可用"（Service not available）。

#### 电话办理

任何电话办理需要 5 分钟。

电话办理只能由空闲的"客户服务窗口"插队处理。

电话办理仅接受银行客户。

在电话办理过程中，银行客户可以：
-   查询其拥有的任何一个账户的当前余额

如果指定账户不存在，银行应拒绝该操作（Incorrect telephone operation. Unknown account）。

客户只能查询属于其的账户余额，否则应拒绝并说明"客户错误"（Client error. Access denied）。

操作格式："%llu # %llu:%llu # Telephone Balance Inquiry # %99[a-zA-Z0-9/_ ] # %llu"，其中格式说明符：
-   当前日期
-   办理时间
-   姓 名 父名 / 组织名称
-   账户号码
输出格式："%llu # %llu:%llu # Telephone Balance of %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   账户号码
-   账户余额（货币单位）

#### 在线操作服务

在线操作不占用银行员工时间。支持以下类型的在线操作。

##### 信用卡支付

此过程减少信贷账户的余额。

如果请求金额大于账户余额，银行应拒绝该操作（Incorrect online operation. Insufficient funds）。

如果指定账户不存在，银行应拒绝该操作（Incorrect online operation. Unknown account）。

手续费：0%

###### 外币支付

以不同于账户货币的货币扣款，根据汇率进行，其中客户购买的货币被视为请求货币，出售的货币是账户货币。此类扣款分两步进行：
1.  将资金从客户账户存入银行内部账户（以客户账户货币）。
2.  从银行内部账户（以请求货币）中取出资金。

如果转出请求货币的银行内部账户资金不足，则银行应拒绝该操作（Incorrect online operation. Can't perform exchange）。

操作格式："%llu # %llu:%llu # Online Credit Card Payment # %llu # %99[a-zA-Z0-9/_ ] # %llu.%llu"，其中格式说明符：
-   当前日期
-   办理时间
-   信贷账户号码
-   请求货币
-   扣款金额（货币单位）
输出格式："%llu # %llu:%llu # Online Credit Card Payment Approved %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   账户号码
-   账户余额（货币单位）

##### 借记卡支付

此过程减少借记账户的余额。

如果请求金额大于账户余额，银行应拒绝该操作（Incorrect online operation. Insufficient funds）。

如果指定账户不存在，银行应拒绝该操作（Incorrect online operation. Unknown account）。

手续费：0%

###### 外币支付

以不同于账户货币的货币扣款，根据汇率进行，其中客户购买的货币被视为请求货币，出售的货币是账户货币。此类扣款分两步进行：
1.  将资金从客户账户存入银行内部账户（以客户账户货币）。
2.  从银行内部账户（以请求货币）中取出资金。

如果转出请求货币的银行内部账户资金不足，则银行应拒绝该操作（Incorrect online operation. Can't perform exchange）。

操作格式："%llu # %llu:%llu # Online Debit Card Payment # %llu # %99[a-zA-Z0-9/_ ] # %llu.%llu"，其中格式说明符：
-   当前日期
-   办理时间
-   借记账户号码
-   请求货币
-   扣款金额（货币单位）
输出格式："%llu # %llu:%llu # Online Debit Card Payment Approved %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   账户号码
-   账户余额（货币单位）

##### 本人账户间转账

此过程减少一个账户的余额并增加另一个账户的余额。

如果请求转账金额大于转出账户的余额，银行应拒绝该操作（Incorrect online operation. Insufficient funds）。

如果任何指定账户不存在，银行应拒绝该操作（Incorrect online operation. Unknown account）。

如果任何账户不属于同一所有者，银行应拒绝转账（Incorrect online operation. Access denied）。

为通过"获取贷款"操作开立的账户充值：当向该账户存入金额时，贷款账户的最终余额不能超过发放的贷款金额。如果存入金额超过，应拒绝客户并说明"客户错误"（Incorrect online operation. Invalid loan payment amount）

###### 外币转账

不同货币账户间的转账根据汇率进行，其中客户购买的货币被视为资金转入的账户货币，出售的货币是资金转出的账户货币。此类转账分两步进行：
1.  将资金从客户转出账户存入银行内部账户（以客户账户货币）。
2.  将资金从银行内部账户（以资金转入的账户货币）存入客户账户。

如果转出货币的银行内部账户资金不足，则银行应拒绝该操作（Incorrect online operation. Can't perform exchange）。

手续费：0%

操作格式："%llu # %llu:%llu # Online Transfer Between My Accounts # %llu -> %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   办理时间
-   转出资金的账户号码
-   接收资金的账户号码
-   转出金额（以转出账户货币计）（货币单位）
输出格式："%llu # %llu:%llu # Online Transfer Between My Accounts Approved %llu -> %llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   转出资金的账户号码
-   接收资金的账户号码

##### 向其他银行客户转账

此过程减少转账客户账户的余额并增加收款客户账户的余额。

如果请求转账金额大于转出账户的余额，银行应拒绝该操作（Incorrect online operation. Insufficient funds）。

如果任何指定账户不存在，银行应拒绝该操作（Incorrect online operation. Unknown account）。

如果客户无法支付手续费，银行应拒绝该操作（Incorrect online operation. Can't withdraw tariff）。

###### 外币转账

不同货币账户间的转账根据汇率进行，其中客户购买的货币被视为资金转入的账户货币，出售的货币是资金转出的账户货币。此类转账分两步进行：
1.  将资金从客户转出账户存入银行内部账户（以客户账户货币）。
2.  将资金从银行内部账户（以资金转入的账户货币）存入客户账户。

如果转出货币的银行内部账户资金不足，则银行应拒绝该操作（Incorrect online operation. Can't perform exchange）。

手续费（向转账客户账户收取）：
-   普通银行客户：转账金额的 1%。
    -   对于货币 "RUB"：每月前 100,000 货币单位免手续费
    -   对于货币 "YUAN"：每月前 10,000 货币单位免手续费
    -   对于货币 "USD"：每月前 1,000 货币单位免手续费
    -   对于货币 "EUR"：每月前 1,000 货币单位免手续费
-   优先银行客户：0%

不同货币账户间的转账根据汇率进行。

操作格式："%llu # %llu:%llu # Online Transfer # %llu -> %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   办理时间
-   转出资金的账户号码
-   接收资金的账户号码
-   转账金额（以转出账户货币计）（货币单位）
输出格式："%llu # %llu:%llu # Online Transfer Approved %llu -> %llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   转出资金的账户号码
-   接收资金的账户号码

##### 从其他银行收款到账户

此过程增加收款银行客户账户的余额。

如果收款账户不存在，银行应拒绝该操作（Incorrect online operation. Unknown account）。

为通过"获取贷款"操作开立的账户充值：当向该账户存入金额时，贷款账户的最终余额不能超过发放的贷款金额。如果存入金额超过，应拒绝客户并说明"客户错误"（Incorrect online operation. Invalid loan payment amount）

手续费：0%

操作格式："%llu # %llu:%llu # Online Inbound Transfer # %llu # %llu.%llu"，其中格式说明符：
-   当前日期
-   办理时间
-   接收资金的账户号码
-   转账金额（以接收账户货币计）（货币单位）
输出格式："%llu # %llu:%llu # Online Inbound Transfer Approved %llu"，其中格式说明符：
-   当前日期
-   操作执行时间
-   接收资金的账户号码

# 参考资料和参考数据

对于表格式数据的存储，应使用已知大小（容量）的 C 风格数组，并附带一个 size 值 - 当前填充度。保证不需要超过 **100000** 个数组元素。

对于数据搜索，应使用 C 风格算法：
-   **std::qsort()** - 用于数据排序（准备 O(Nlog N) 搜索）
-   **std::bsearch()** - 用于数据搜索（O(log N) 搜索）
-   允许通过 for 循环进行线性搜索
-   对于字符串比较，使用函数 **std::strncmp()**

**[文件内容结束]**